```sql
/* Distribution((ID, #NUMFO, #CODE_INSEE, ADRESSE, STATUT, …) Operateur(NUMFO, NOMFO, GENERATION, TECHNOLOGIE) Commune(CODE_INSEE, NOMCOMMUNE, #NOMDEP) Departement(NOMDEP, CODE_DEPARTEMENT) */ SELECT * FROM basetd.distribution; SELECT * FROM basetd.operateur; SELECT * FROM basetd.commune; SELECT * FROM basetd.departement; /* Question 1 : Afficher les différents opérateurs de votre ville de naissance. En sortie : nomCommune, code_insee, nomfo, generation, technologie, nomdep, code_departement, adresse, etc...) Tables : distribution, operateur, commune, departement Jointures : ? Sortie : nomCommune, code_insee, nomfo, generation, technologie, nomdep, code_departement */ -- commune : ligne 705 : 44066 Grandchamps-des-Fontaines Loire-Atlantique SELECT DISTINCT c.nom_commune, c.code_insee, d.numfo, o.generation, o.technologie, dep.nomdep, dep.code_departement FROM basetd.commune c JOIN basetd.distribution d ON c.code_insee = d.code_insee JOIN basetd.operateur o ON d.numfo = o.numfo JOIN basetd.departement dep ON c.nomdep = dep.nomdep WHERE c.nom_commune = 'Grandchamps-des-Fontaines'; /* Question 2 : Afficher les opérateurs 5G de la Ville de Nantes. En sortie idem que la question 1 .(résultat : 317 lignes) */ SELECT c.nom_commune, c.code_insee, d.numfo, o.generation, o.technologie, dep.nomdep, dep.code_departement FROM basetd.commune c JOIN basetd.distribution d ON c.code_insee = d.code_insee JOIN basetd.operateur o ON d.numfo = o.numfo JOIN basetd.departement dep ON c.nomdep = dep.nomdep WHERE c.nom_commune = 'Nantes' AND o.generation = '5G'; /* Question 3 : Afficher les lieux(adresse, nom l'opérateur) où sont installés les opérateurs 5G avec la fréquence 3,5 GHZ( '5G NR 3500') de la ville de Nantes. Le résultat est donné par ordre croissant */ SELECT d.adresse, o.nomfo FROM basetd.commune c JOIN basetd.distribution d ON c.code_insee = d.code_insee JOIN basetd.operateur o ON d.numfo = o.numfo JOIN basetd.departement dep ON c.nomdep = dep.nomdep WHERE c.nom_commune = 'Nantes' AND o.technologie = '5G NR 3500'; /* Question 4 : Afficher pour chacune des communes le nom de la commune, le nom de l'operateur avec la technologie 5G(sans la clause Distinct). Vous affichez aussi en sortie la colonne generation( 2525 lignes) */ SELECT c.nom_commune, o.nomfo, o.technologie FROM basetd.commune c JOIN basetd.distribution d ON c.code_insee = d.code_insee JOIN basetd.operateur o ON d.numfo = o.numfo JOIN basetd.departement dep ON c.nomdep = dep.nomdep WHERE o.generation = '5G'; /* Question 5 : Afficher pour chacune des communes le nom de l'operateur et le nombre d'antennes 5G qui sont installées par opérateur. Vous donnez le résultat par ordre décroissant du nombre d'antennes, et ordre croissant des communes */ -- Il faut un compte quelque part -> créer une table avec un select et la compté SELECT c.nom_commune, o.nomfo, COUNT(*) AS nombre FROM basetd.commune c, basetd.distribution d, basetd.operateur o, basetd.departement dep WHERE c.code_insee = d.code_insee AND d.numfo = o.numfo AND c.nomdep = dep.nomdep AND o.generation = '5G' GROUP BY c.nom_commune, o.nomfo ORDER BY nombre DESC, c.nom_commune ASC ; /* Question 6 : Idem que la question 5, mais sans afficher le nom de l'opérateur. Par contre dans ce cas vous affichez que les 10 meilleurs villes avec la 5G. Pour afficher les 10 premières lignes de la requête, vous pouvez utiliser la commande FETCH après l'order by */ SELECT c.nom_commune, COUNT(*) AS nombre FROM basetd.commune c, basetd.distribution d, basetd.operateur o, basetd.departement dep WHERE c.code_insee = d.code_insee AND d.numfo = o.numfo AND c.nomdep = dep.nomdep AND o.generation = '5G' GROUP BY c.nom_commune ORDER BY nombre DESC, c.nom_commune ASC FETCH NEXT 10 ROWS ONLY ; /* Question 7 : idem que la Q5 avec seulement les villes qui possèdent plus de 50 antennes 5G.(5lignes) */ SELECT c.nom_commune, COUNT(*) AS nombre FROM basetd.commune c, basetd.distribution d, basetd.operateur o, basetd.departement dep WHERE c.code_insee = d.code_insee AND d.numfo = o.numfo AND c.nomdep = dep.nomdep AND o.generation = '5G' HAVING COUNT (o.generation) >= 50 GROUP BY c.nom_commune ORDER BY nombre DESC, c.nom_commune ASC ; /* Question 8 : Afficher par département les noms des opérateurs et le nombre d'antennes 4G installées */ SELECT dep.nomdep, o.nomfo, COUNT(*) AS nombre FROM basetd.commune c, basetd.distribution d, basetd.operateur o, basetd.departement dep WHERE c.code_insee = d.code_insee AND d.numfo = o.numfo AND c.nomdep = dep.nomdep AND o.generation = '4G' GROUP BY dep.nomdep, o.nomfo ORDER BY dep.nomdep ASC, nombre DESC ;
```