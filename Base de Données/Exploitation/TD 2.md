```sql
/* 
Distribution((ID, #NUMFO, #CODE_INSEE, ADRESSE, STATUT, …)
Operateur(NUMFO, NOMFO, GENERATION, TECHNOLOGIE) 
Commune(CODE_INSEE, NOMCOMMUNE, #NOMDEP) 
Departement(NOMDEP, CODE_DEPARTEMENT) 
*/ 
SELECT * FROM basetd.distribution; 
SELECT * FROM basetd.operateur; 
SELECT * FROM basetd.commune; 
SELECT * FROM basetd.departement; 
/* 
Question 1 : Liste des communes qui se trouvent dans le département 49(Vous le faites sous deux formes : in et exists)(130lignes) 
*/ 
-- Version IN 
SELECT c.nom_commune 
FROM basetd.commune c 
WHERE c.nomdep IN ( 
	SELECT dep.nomdep 
	FROM basetd.departement dep 
	WHERE dep.code_departement = 49 
	) 
; 
-- Version EXISTS 
SELECT c.nom_commune 
FROM basetd.commune c 
WHERE EXISTS ( 
	SELECT dep.nomdep 
	FROM basetd.departement dep 
	WHERE dep.code_departement = 49 AND c.nomdep = dep.nomdep 
	) 
; 

/* 
Question 2 : Liste des noms des communes avec le nom du département qui disposent de la 5G (Vous le faites sous deux formes : in et exists)(622 lignes) 
*/ 
-- IN 
SELECT DISTINCT c.nom_commune, c.nomdep 
FROM basetd.commune c 
WHERE c.code_insee IN ( 
	SELECT d.code_insee 
	FROM basetd.distribution d 
	WHERE d.numfo IN ( 
		SELECT o.numfo 
		FROM basetd.operateur o 
		WHERE o.generation = '5G' 
		) 
	) 
; 
-- EXISTS 
SELECT DISTINCT c.nom_commune, c.nomdep 
FROM basetd.commune c 
WHERE EXISTS ( 
	SELECT d.code_insee 
	FROM basetd.distribution d 
	WHERE EXISTS ( 
		SELECT o.numfo 
		FROM basetd.operateur o 
		WHERE o.generation = '5G' AND o.numfo = d.numfo AND d.code_insee = c.code_insee 
		) 
	) 
; 

/* 
Question 3 : Liste des communes avec le nom du departement qui ne possèdent pas la 5G (versions avec not in et not exists) (249 lignes) */ 
-- IN 
SELECT DISTINCT c.nom_commune, c.nomdep 
FROM basetd.commune c 
WHERE c.code_insee NOT IN ( 
	SELECT d.code_insee 
	FROM basetd.distribution d 
	WHERE d.numfo IN ( 
		SELECT o.numfo 
		FROM basetd.operateur o 
		WHERE o.generation = '5G' 
		) 
	) 
; 
-- EXISTS 
SELECT DISTINCT c.nom_commune, c.nomdep 
FROM basetd.commune c 
WHERE NOT EXISTS ( 
	SELECT d.code_insee 
	FROM basetd.distribution d 
	WHERE EXISTS ( 
		SELECT o.numfo 
		FROM basetd.operateur o 
		WHERE o.generation = '5G' AND o.numfo = d.numfo AND d.code_insee = c.code_insee 
		) 
	) 
; 

/* 
Question 4 : Liste des communes qui ne possèdent pas la 5G et qui se trouvent dans le département 44(versions avec not in et not exists) (30 lignes) 
*/ 
-- IN 
SELECT DISTINCT c.nom_commune, c.nomdep 
FROM basetd.commune c 
WHERE c.code_insee NOT IN ( 
	SELECT d.code_insee 
	FROM basetd.distribution d 
	WHERE d.numfo IN ( 
		SELECT o.numfo 
		FROM basetd.operateur o 
		WHERE o.generation = '5G' 
		) 
	) AND c.nomdep IN ( 
		SELECT dep.nomdep 
		FROM basetd.departement dep 
		WHERE dep.code_departement = 44 
	) 
; 
-- EXISTS 
SELECT DISTINCT c.nom_commune, c.nomdep 
FROM basetd.commune c 
WHERE NOT EXISTS ( 
	SELECT d.code_insee 
	FROM basetd.distribution d 
	WHERE EXISTS ( 
		SELECT o.numfo 
		FROM basetd.operateur o 
		WHERE o.generation = '5G' AND o.numfo = d.numfo AND d.code_insee = c.code_insee 
		) 
	) AND EXISTS ( 
		SELECT dep.nomdep 
		FROM basetd.departement dep 
		WHERE dep.code_departement = 44 AND dep.nomdep = c.nomdep 
	) 
; 

/* 
Question 5 : Afficher pour chaque département le nombre de communes(sous deux formes). Faites une jointure de la table commune et celle du département.(5 lignes) 
*/ 
-- IN 
SELECT c.nomdep, COUNT(*) as nombre_communes 
FROM basetd.commune c 
WHERE c.nomdep IN ( 
	SELECT dep.nomdep 
	FROM basetd.departement dep ) 
	GROUP BY c.nomdep ; 
-- EXISTS 
SELECT c.nomdep, COUNT(*) as nombre_communes 
FROM basetd.commune c 
WHERE EXISTS ( 
	SELECT dep.nomdep 
	FROM basetd.departement dep 
	WHERE c.nomdep = dep.nomdep ) 
	GROUP BY c.nomdep 
; 

/* Question 6 : 
Liste de toutes les communes de Loire-Atlantique avec le nombre d'antennes 5G. Le résultat est trié par ordre croissant de la deuxième colonne(sous deux formes). Avez-vous le même résultat avec les deux formes.(164 lignes la première version et 317 la deuxième version). La deuxième version donne les 0 pour les villes qui n’ont pas la 5G 
*/ 
-- IN 
SELECT DISTINCT c.nom_commune 
FROM basetd.commune c 
WHERE c.code_insee IN ( 
	SELECT d.code_insee 
	FROM basetd.distribution d 
	WHERE d.numfo IN ( 
		SELECT o.numfo 
		FROM basetd.operateur o 
		-- WHERE o.generation = '5G' 
		) 
	) 
;
```